// Generated by delombok at Thu Jul 04 12:27:09 CEST 2024
package no.nav.melosys.eessi.controller;

import no.nav.melosys.eessi.controller.dto.SedDataDto;
import no.nav.melosys.eessi.models.SedType;
import no.nav.melosys.eessi.models.exception.ValidationException;
import no.nav.melosys.eessi.service.journalfoering.OpprettUtgaaendeJournalpostService;
import no.nav.melosys.eessi.service.sed.SedService;
import no.nav.security.token.support.core.api.Protected;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpStatus;
import org.springframework.web.bind.annotation.*;

@Protected
@RestController
@RequestMapping
public class SedController {
    @java.lang.SuppressWarnings("all")
    private static final org.slf4j.Logger log = org.slf4j.LoggerFactory.getLogger(SedController.class);
    private final SedService sedService;
    private final OpprettUtgaaendeJournalpostService opprettUtgaaendeJournalpostService;

    @Autowired
    public SedController(SedService sedService, OpprettUtgaaendeJournalpostService opprettUtgaaendeJournalpostService) {
        this.sedService = sedService;
        this.opprettUtgaaendeJournalpostService = opprettUtgaaendeJournalpostService;
    }

    @PostMapping("/sed/{sedType}/pdf")
    public byte[] genererPdfFraSed(@RequestBody SedDataDto sedDataDto, @PathVariable SedType sedType) throws ValidationException {
        if (sedType.kreverAdresse() && sedDataDto.manglerAdresser()) {
            throw new ValidationException("Personen mangler adresse ved PDF generering");
        }
        return sedService.genererPdfFraSed(sedDataDto, sedType);
    }

    @PostMapping("/journalfoerTidligereSendteSedFor/{rinaSaksnummer}")
    @ResponseStatus(HttpStatus.OK)
    public void journalfoerTidligereSendteSed(@PathVariable String rinaSaksnummer) {
        opprettUtgaaendeJournalpostService.journalfoerTidligereSedDersomEksisterer(rinaSaksnummer);
    }
}
