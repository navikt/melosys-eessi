// Generated by delombok at Thu Jul 04 12:27:09 CEST 2024
package no.nav.melosys.eessi.controller.dto;

import java.util.List;
import java.util.Set;
import java.util.function.Predicate;
import java.util.stream.Collectors;

import no.nav.melosys.eessi.models.buc.BUC;
import no.nav.melosys.eessi.models.buc.Document;
import no.nav.melosys.eessi.models.buc.Organisation;
import no.nav.melosys.eessi.models.buc.Participant;

public class BucinfoDto {
    private String id;
    private boolean erÅpen;
    private String bucType;
    private Long opprettetDato;
    private Set<String> mottakerinstitusjoner;
    private List<SedinfoDto> seder;

    public static BucinfoDto av(BUC buc, List<String> statuser, String rinaSedUrl) {
        return BucinfoDto.builder().id(buc.getId()).erÅpen(buc.erÅpen()).bucType(buc.getBucType()).opprettetDato(buc.getStartDate().toInstant().toEpochMilli()).mottakerinstitusjoner(hentMottakerinstitusjonerFraBuc(buc)).seder(buc.getDocuments().stream().filter(filtrerMedStatus(statuser)).map(doc -> SedinfoDto.av(doc, buc.getId(), rinaSedUrl)).collect(Collectors.toList())).build();
    }

    private static Predicate<Document> filtrerMedStatus(List<String> statuser) {
        if (statuser == null || statuser.isEmpty()) {
            return b -> true;
        }
        return b -> statuser.stream().map(SedStatus::fraNorskStatus).anyMatch(status -> status == SedStatus.fraEngelskStatus(b.getStatus()));
    }

    private static Set<String> hentMottakerinstitusjonerFraBuc(BUC buc) {
        return buc.getDocuments().stream().flatMap(document -> document.getConversations().stream().flatMap(conversation -> conversation.getParticipants().stream())).filter(participant -> participant.getRole() == Participant.ParticipantRole.MOTTAKER).map(Participant::getOrganisation).map(Organisation::getId).collect(Collectors.toSet());
    }


    @java.lang.SuppressWarnings("all")
    public static class BucinfoDtoBuilder {
        @java.lang.SuppressWarnings("all")
        private String id;
        @java.lang.SuppressWarnings("all")
        private boolean erÅpen;
        @java.lang.SuppressWarnings("all")
        private String bucType;
        @java.lang.SuppressWarnings("all")
        private Long opprettetDato;
        @java.lang.SuppressWarnings("all")
        private Set<String> mottakerinstitusjoner;
        @java.lang.SuppressWarnings("all")
        private List<SedinfoDto> seder;

        @java.lang.SuppressWarnings("all")
        BucinfoDtoBuilder() {
        }

        /**
         * @return {@code this}.
         */
        @java.lang.SuppressWarnings("all")
        public BucinfoDto.BucinfoDtoBuilder id(final String id) {
            this.id = id;
            return this;
        }

        /**
         * @return {@code this}.
         */
        @java.lang.SuppressWarnings("all")
        public BucinfoDto.BucinfoDtoBuilder erÅpen(final boolean erÅpen) {
            this.erÅpen = erÅpen;
            return this;
        }

        /**
         * @return {@code this}.
         */
        @java.lang.SuppressWarnings("all")
        public BucinfoDto.BucinfoDtoBuilder bucType(final String bucType) {
            this.bucType = bucType;
            return this;
        }

        /**
         * @return {@code this}.
         */
        @java.lang.SuppressWarnings("all")
        public BucinfoDto.BucinfoDtoBuilder opprettetDato(final Long opprettetDato) {
            this.opprettetDato = opprettetDato;
            return this;
        }

        /**
         * @return {@code this}.
         */
        @java.lang.SuppressWarnings("all")
        public BucinfoDto.BucinfoDtoBuilder mottakerinstitusjoner(final Set<String> mottakerinstitusjoner) {
            this.mottakerinstitusjoner = mottakerinstitusjoner;
            return this;
        }

        /**
         * @return {@code this}.
         */
        @java.lang.SuppressWarnings("all")
        public BucinfoDto.BucinfoDtoBuilder seder(final List<SedinfoDto> seder) {
            this.seder = seder;
            return this;
        }

        @java.lang.SuppressWarnings("all")
        public BucinfoDto build() {
            return new BucinfoDto(this.id, this.erÅpen, this.bucType, this.opprettetDato, this.mottakerinstitusjoner, this.seder);
        }

        @java.lang.Override
        @java.lang.SuppressWarnings("all")
        public java.lang.String toString() {
            return "BucinfoDto.BucinfoDtoBuilder(id=" + this.id + ", erÅpen=" + this.erÅpen + ", bucType=" + this.bucType + ", opprettetDato=" + this.opprettetDato + ", mottakerinstitusjoner=" + this.mottakerinstitusjoner + ", seder=" + this.seder + ")";
        }
    }

    @java.lang.SuppressWarnings("all")
    public static BucinfoDto.BucinfoDtoBuilder builder() {
        return new BucinfoDto.BucinfoDtoBuilder();
    }

    @java.lang.SuppressWarnings("all")
    public String getId() {
        return this.id;
    }

    @java.lang.SuppressWarnings("all")
    public boolean isErÅpen() {
        return this.erÅpen;
    }

    @java.lang.SuppressWarnings("all")
    public String getBucType() {
        return this.bucType;
    }

    @java.lang.SuppressWarnings("all")
    public Long getOpprettetDato() {
        return this.opprettetDato;
    }

    @java.lang.SuppressWarnings("all")
    public Set<String> getMottakerinstitusjoner() {
        return this.mottakerinstitusjoner;
    }

    @java.lang.SuppressWarnings("all")
    public List<SedinfoDto> getSeder() {
        return this.seder;
    }

    @java.lang.SuppressWarnings("all")
    public void setId(final String id) {
        this.id = id;
    }

    @java.lang.SuppressWarnings("all")
    public void setErÅpen(final boolean erÅpen) {
        this.erÅpen = erÅpen;
    }

    @java.lang.SuppressWarnings("all")
    public void setBucType(final String bucType) {
        this.bucType = bucType;
    }

    @java.lang.SuppressWarnings("all")
    public void setOpprettetDato(final Long opprettetDato) {
        this.opprettetDato = opprettetDato;
    }

    @java.lang.SuppressWarnings("all")
    public void setMottakerinstitusjoner(final Set<String> mottakerinstitusjoner) {
        this.mottakerinstitusjoner = mottakerinstitusjoner;
    }

    @java.lang.SuppressWarnings("all")
    public void setSeder(final List<SedinfoDto> seder) {
        this.seder = seder;
    }

    @java.lang.Override
    @java.lang.SuppressWarnings("all")
    public boolean equals(final java.lang.Object o) {
        if (o == this) return true;
        if (!(o instanceof BucinfoDto)) return false;
        final BucinfoDto other = (BucinfoDto) o;
        if (!other.canEqual((java.lang.Object) this)) return false;
        if (this.isErÅpen() != other.isErÅpen()) return false;
        final java.lang.Object this$opprettetDato = this.getOpprettetDato();
        final java.lang.Object other$opprettetDato = other.getOpprettetDato();
        if (this$opprettetDato == null ? other$opprettetDato != null : !this$opprettetDato.equals(other$opprettetDato)) return false;
        final java.lang.Object this$id = this.getId();
        final java.lang.Object other$id = other.getId();
        if (this$id == null ? other$id != null : !this$id.equals(other$id)) return false;
        final java.lang.Object this$bucType = this.getBucType();
        final java.lang.Object other$bucType = other.getBucType();
        if (this$bucType == null ? other$bucType != null : !this$bucType.equals(other$bucType)) return false;
        final java.lang.Object this$mottakerinstitusjoner = this.getMottakerinstitusjoner();
        final java.lang.Object other$mottakerinstitusjoner = other.getMottakerinstitusjoner();
        if (this$mottakerinstitusjoner == null ? other$mottakerinstitusjoner != null : !this$mottakerinstitusjoner.equals(other$mottakerinstitusjoner)) return false;
        final java.lang.Object this$seder = this.getSeder();
        final java.lang.Object other$seder = other.getSeder();
        if (this$seder == null ? other$seder != null : !this$seder.equals(other$seder)) return false;
        return true;
    }

    @java.lang.SuppressWarnings("all")
    protected boolean canEqual(final java.lang.Object other) {
        return other instanceof BucinfoDto;
    }

    @java.lang.Override
    @java.lang.SuppressWarnings("all")
    public int hashCode() {
        final int PRIME = 59;
        int result = 1;
        result = result * PRIME + (this.isErÅpen() ? 79 : 97);
        final java.lang.Object $opprettetDato = this.getOpprettetDato();
        result = result * PRIME + ($opprettetDato == null ? 43 : $opprettetDato.hashCode());
        final java.lang.Object $id = this.getId();
        result = result * PRIME + ($id == null ? 43 : $id.hashCode());
        final java.lang.Object $bucType = this.getBucType();
        result = result * PRIME + ($bucType == null ? 43 : $bucType.hashCode());
        final java.lang.Object $mottakerinstitusjoner = this.getMottakerinstitusjoner();
        result = result * PRIME + ($mottakerinstitusjoner == null ? 43 : $mottakerinstitusjoner.hashCode());
        final java.lang.Object $seder = this.getSeder();
        result = result * PRIME + ($seder == null ? 43 : $seder.hashCode());
        return result;
    }

    @java.lang.Override
    @java.lang.SuppressWarnings("all")
    public java.lang.String toString() {
        return "BucinfoDto(id=" + this.getId() + ", erÅpen=" + this.isErÅpen() + ", bucType=" + this.getBucType() + ", opprettetDato=" + this.getOpprettetDato() + ", mottakerinstitusjoner=" + this.getMottakerinstitusjoner() + ", seder=" + this.getSeder() + ")";
    }

    @java.lang.SuppressWarnings("all")
    public BucinfoDto() {
    }

    @java.lang.SuppressWarnings("all")
    public BucinfoDto(final String id, final boolean erÅpen, final String bucType, final Long opprettetDato, final Set<String> mottakerinstitusjoner, final List<SedinfoDto> seder) {
        this.id = id;
        this.erÅpen = erÅpen;
        this.bucType = bucType;
        this.opprettetDato = opprettetDato;
        this.mottakerinstitusjoner = mottakerinstitusjoner;
        this.seder = seder;
    }
}
